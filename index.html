<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next Growth - Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-storage-compat.js"></script>
    <style>
        :root {
            --neon-blue: #08f;
            --neon-purple: #a0f;
            --neon-green: #0f8;
            --dark-bg: #121212;
            --darker-bg: #0a0a0a;
            --card-bg: #1a1a1a;
            --text-color: #f0f0f0;
            --text-dim: #b0b0b0;
            --danger: #ff4d4d;
            --warning: #ffcc00;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: var(--dark-bg);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 70px; /* Space for mobile nav */
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 80px; /* Space for header */
        }

        /* Header Styles */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--darker-bg);
            border-bottom: 1px solid rgba(160, 255, 136, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(0, 136, 255, 0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 5px rgba(0, 136, 255, 0.5), 0 0 10px rgba(0, 136, 255, 0.3);
            }
            to {
                text-shadow: 0 0 10px rgba(0, 136, 255, 0.8), 0 0 20px rgba(0, 136, 255, 0.5), 0 0 30px rgba(0, 136, 255, 0.3);
            }
        }

        .admin-nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--text-dim);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px 12px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .nav-btn i {
            font-size: 1.2rem;
        }

        .nav-btn:hover {
            color: var(--neon-blue);
            background-color: rgba(0, 136, 255, 0.1);
        }

        .nav-btn.active {
            color: var(--neon-green);
            background-color: rgba(0, 255, 136, 0.1);
        }

        .logout-btn {
            background: none;
            border: none;
            color: var(--neon-blue);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px 12px;
            border-radius: 5px;
            margin-left: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .logout-btn i {
            font-size: 1.2rem;
        }

        .logout-btn:hover {
            color: var(--neon-purple);
            background-color: rgba(160, 0, 255, 0.1);
        }

        /* Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--darker-bg);
            border-top: 1px solid rgba(160, 255, 136, 0.1);
            z-index: 1000;
            padding: 10px 0;
        }

        .mobile-nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .mobile-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            color: var(--text-dim);
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px 5px;
            border-radius: 5px;
            width: 100%;
        }

        .mobile-nav-btn i {
            font-size: 1.4rem;
            margin-bottom: 5px;
        }

        .mobile-nav-btn:hover {
            color: var(--neon-blue);
            background-color: rgba(0, 136, 255, 0.1);
        }

        .mobile-nav-btn.active {
            color: var(--neon-green);
            background-color: rgba(0, 255, 136, 0.1);
        }

        /* Auth Section */
        .auth-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 70vh;
            padding: 20px;
        }

        .auth-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 0 20px rgba(0, 136, 255, 0.2);
            border: 1px solid rgba(0, 136, 255, 0.1);
            transition: all 0.3s;
        }

        .auth-card:hover {
            box-shadow: 0 0 30px rgba(0, 136, 255, 0.3);
            border: 1px solid rgba(0, 136, 255, 0.3);
        }

        .auth-title {
            font-family: 'Orbitron', sans-serif;
            text-align: center;
            margin-bottom: 20px;
            color: var(--neon-blue);
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: var(--text-dim);
        }

        .form-input {
            width: 100%;
            padding: 10px;
            background-color: var(--darker-bg);
            border: 1px solid rgba(0, 136, 255, 0.3);
            border-radius: 5px;
            color: var(--text-color);
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--neon-blue);
            box-shadow: 0 0 10px rgba(0, 136, 255, 0.3);
        }

        .submit-btn {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 136, 255, 0.1);
            color: var(--neon-blue);
            border: 1px solid var(--neon-blue);
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(0, 136, 255, 0.2);
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .submit-btn:hover {
            background-color: rgba(0, 136, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 136, 255, 0.4);
        }

        /* Dashboard Styles */
        .admin-dashboard {
            display: none;
            padding: 20px 0;
        }

        .section-title {
            font-family: 'Orbitron', sans-serif;
            color: var(--neon-blue);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.1);
            position: relative;
            overflow: hidden;
        }

        .card-title {
            font-size: 1.1rem;
            color: var(--neon-green);
            margin-bottom: 15px;
            font-family: 'Orbitron', sans-serif;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-color);
            text-align: center;
            margin: 10px 0;
        }

        .card-subtitle {
            color: var(--text-dim);
            font-size: 0.9rem;
            text-align: center;
        }

        /* Deposit Requests */
        .deposit-requests {
            display: none;
        }

        .requests-container {
            overflow-x: auto;
        }

        .requests-table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .requests-table th, .requests-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .requests-table th {
            background-color: var(--darker-bg);
            color: var(--neon-blue);
            font-weight: 500;
        }

        .requests-table tr:hover {
            background-color: rgba(0, 136, 255, 0.05);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            display: flex;
            align-items: center;
            gap: 5px;
            min-width: 80px;
        }

        .btn i {
            font-size: 0.9rem;
        }

        .btn-approve {
            background-color: rgba(0, 255, 136, 0.1);
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
        }

        .btn-approve:hover {
            background-color: rgba(0, 255, 136, 0.2);
        }

        .btn-reject {
            background-color: rgba(255, 77, 77, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .btn-reject:hover {
            background-color: rgba(255, 77, 77, 0.2);
        }

        /* Add Service Section */
        .add-service {
            display: none;
        }

        .service-form {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        /* API Config Section */
        .api-config {
            display: none;
        }

        /* QR Code Section */
        .qr-config {
            display: none;
        }

        .qr-preview {
            width: 200px;
            height: 200px;
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 20px auto;
            display: block;
            border: 2px solid var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 136, 255, 0.3);
            object-fit: contain;
        }

        /* Send Dialog Section */
        .send-dialog {
            display: none;
        }

        .dialog-form {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        textarea.form-input {
            min-height: 150px;
            resize: vertical;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--card-bg);
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            padding: 20px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
            border: 1px solid var(--neon-green);
            position: relative;
            transform: scale(0.9);
            transition: all 0.3s;
        }

        .modal-overlay.show .modal {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .modal-title {
            font-family: 'Orbitron', sans-serif;
            color: var(--neon-green);
            font-size: 1.2rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-dim);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-close:hover {
            color: var(--neon-purple);
        }

        .modal-body {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-btn {
            padding: 8px 15px;
            background-color: rgba(0, 255, 136, 0.1);
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .modal-btn:hover {
            background-color: rgba(0, 255, 136, 0.2);
        }

        .modal-btn.cancel {
            background-color: rgba(255, 77, 77, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .modal-btn.cancel:hover {
            background-color: rgba(255, 77, 77, 0.2);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--card-bg);
            color: var(--text-color);
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            border-left: 4px solid var(--neon-green);
            transform: translateX(150%);
            transition: all 0.3s;
            z-index: 1000;
            max-width: 300px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast-message {
            font-size: 0.9rem;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 136, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--neon-blue);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-dim);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--neon-purple);
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .dashboard-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
            
            .nav-btn span {
                display: none;
            }
            
            .nav-btn i {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 768px) {
            .logo {
                font-size: 1.2rem;
            }
            
            .admin-nav {
                display: none;
            }
            
            .mobile-nav {
                display: block;
            }
            
            .container {
                padding-top: 70px;
            }
            
            .auth-card {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.1rem;
            }
            
            .card {
                padding: 15px;
            }
            
            .card-value {
                font-size: 1.8rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 1rem;
            }
            
            .logout-btn span {
                display: none;
            }
            
            .container {
                padding: 15px;
                padding-top: 60px;
            }
            
            .auth-card {
                padding: 15px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .qr-preview {
                width: 150px;
                height: 150px;
            }
            
            .mobile-nav-btn span {
                font-size: 0.6rem;
            }
            
            .mobile-nav-btn i {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">Next Growth Admin</div>
        <div class="admin-nav" id="adminNav" style="display: none;">
            <button class="nav-btn active" data-section="dashboard">
                <i class="fas fa-chart-bar"></i>
                <span>Dashboard</span>
            </button>
            <button class="nav-btn" data-section="deposits">
                <i class="fas fa-money-bill-wave"></i>
                <span>Deposits</span>
            </button>
            <button class="nav-btn" data-section="services">
                <i class="fas fa-plus-circle"></i>
                <span>Services</span>
            </button>
            <button class="nav-btn" data-section="api">
                <i class="fas fa-cog"></i>
                <span>API</span>
            </button>
            <button class="nav-btn" data-section="qr">
                <i class="fas fa-qrcode"></i>
                <span>QR Code</span>
            </button>
            <button class="nav-btn" data-section="dialog">
                <i class="fas fa-comment-alt"></i>
                <span>Dialog</span>
            </button>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </header>

    <!-- Mobile Navigation -->
    <div class="mobile-nav" id="mobileNav" style="display: none;">
        <div class="mobile-nav-container">
            <button class="mobile-nav-btn active" data-section="dashboard">
                <i class="fas fa-chart-bar"></i>
                <span>Dashboard</span>
            </button>
            <button class="mobile-nav-btn" data-section="deposits">
                <i class="fas fa-money-bill-wave"></i>
                <span>Deposits</span>
            </button>
            <button class="mobile-nav-btn" data-section="services">
                <i class="fas fa-plus-circle"></i>
                <span>Services</span>
            </button>
            <button class="mobile-nav-btn" data-section="api">
                <i class="fas fa-cog"></i>
                <span>API</span>
            </button>
            <button class="mobile-nav-btn" data-section="qr">
                <i class="fas fa-qrcode"></i>
                <span>QR</span>
            </button>
            <button class="mobile-nav-btn" data-section="dialog">
                <i class="fas fa-comment-alt"></i>
                <span>Dialog</span>
            </button>
            <button class="mobile-nav-btn" id="mobileLogoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Auth Section -->
        <section class="auth-section" id="authSection">
            <div class="auth-card">
                <h2 class="auth-title">Admin Login</h2>
                <div class="form-group">
                    <label class="form-label" for="adminPassword">Admin Password</label>
                    <input type="password" class="form-input" id="adminPassword" placeholder="Enter admin password">
                </div>
                <button class="submit-btn" id="loginBtn">
                    <i class="fas fa-lock"></i>
                    <span>Login</span>
                </button>
            </div>
        </section>

        <!-- Admin Dashboard -->
        <section class="admin-dashboard" id="adminDashboard">
            <h2 class="section-title">Admin Dashboard</h2>
            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-title">Pending Deposits</div>
                    <div class="card-value" id="pendingDeposits">0</div>
                    <div class="card-subtitle">Requests awaiting approval</div>
                </div>
                <div class="card">
                    <div class="card-title">Total Users</div>
                    <div class="card-value" id="totalUsers">0</div>
                    <div class="card-subtitle">Registered accounts</div>
                </div>
                <div class="card">
                    <div class="card-title">Active Services</div>
                    <div class="card-value" id="activeServices">0</div>
                    <div class="card-subtitle">Available services</div>
                </div>
                <div class="card">
                    <div class="card-title">Total Orders</div>
                    <div class="card-value" id="totalOrders">0</div>
                    <div class="card-subtitle">Completed orders</div>
                </div>
            </div>
        </section>

        <!-- Deposit Requests Section -->
        <section class="deposit-requests" id="depositRequests">
            <h2 class="section-title">Deposit Requests</h2>
            <div class="requests-container">
                <table class="requests-table" id="requestsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>User</th>
                            <th>UTR</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="requestsBody">
                        <!-- Rows will be added dynamically -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Add Service Section -->
        <section class="add-service" id="addService">
            <h2 class="section-title">Add New Service</h2>
            <div class="service-form">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="serviceName">Service Name</label>
                        <input type="text" class="form-input" id="serviceName" placeholder="Enter service name">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="serviceId">Service ID</label>
                        <input type="text" class="form-input" id="serviceId" placeholder="Enter API service ID">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="serviceDesc">Description</label>
                    <textarea class="form-input" id="serviceDesc" placeholder="Enter service description"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="serviceRate">Price per Unit (₹)</label>
                        <input type="number" class="form-input" id="serviceRate" placeholder="Enter price per unit" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="minQty">Minimum Quantity</label>
                        <input type="number" class="form-input" id="minQty" placeholder="Enter minimum quantity" min="1">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="serviceCategory">Category</label>
                    <input type="text" class="form-input" id="serviceCategory" placeholder="Enter service category">
                </div>
                <button class="submit-btn" id="addServiceBtn">
                    <i class="fas fa-plus"></i>
                    <span>Add Service</span>
                </button>
            </div>
        </section>

        <!-- API Config Section -->
        <section class="api-config" id="apiConfig">
            <h2 class="section-title">API Configuration</h2>
            <div class="service-form">
                <div class="form-group">
                    <label class="form-label" for="apiKey">API Key</label>
                    <input type="text" class="form-input" id="apiKey" placeholder="Enter your API key">
                </div>
                <div class="form-group">
                    <label class="form-label" for="apiUrl">API URL</label>
                    <input type="text" class="form-input" id="apiUrl" placeholder="Enter API endpoint URL">
                </div>
                <button class="submit-btn" id="saveApiBtn">
                    <i class="fas fa-save"></i>
                    <span>Save API Config</span>
                </button>
            </div>
        </section>

        <!-- QR Code Section -->
        <section class="qr-config" id="qrConfig">
            <h2 class="section-title">QR Code Configuration</h2>
            <div class="service-form">
                <div class="form-group">
                    <label class="form-label" for="qrUrl">QR Code URL</label>
                    <input type="text" class="form-input" id="qrUrl" placeholder="Enter PNG image URL">
                </div>
                <img src="" alt="Current QR Code" class="qr-preview" id="qrPreview">
                <button class="submit-btn" id="saveQrBtn">
                    <i class="fas fa-sync-alt"></i>
                    <span>Update QR Code</span>
                </button>
            </div>
        </section>

        <!-- Send Dialog Section -->
        <section class="send-dialog" id="sendDialog">
            <h2 class="section-title">Send Dialog to Users</h2>
            <div class="dialog-form">
                <div class="form-group">
                    <label class="form-label" for="dialogTitle">Dialog Title</label>
                    <input type="text" class="form-input" id="dialogTitle" placeholder="Enter dialog title">
                </div>
                <div class="form-group">
                    <label class="form-label" for="dialogMessage">Message</label>
                    <textarea class="form-input" id="dialogMessage" placeholder="Enter your message for all users"></textarea>
                </div>
                <button class="submit-btn" id="sendDialogBtn">
                    <i class="fas fa-paper-plane"></i>
                    <span>Send Dialog to All Users</span>
                </button>
            </div>
        </section>
    </div>

    <!-- Modal for Approve Deposit -->
    <div class="modal-overlay" id="approveModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Approve Deposit</h3>
                <button class="modal-close" id="closeApprove">&times;</button>
            </div>
            <div class="modal-body">
                <p>Enter the deposit amount:</p>
                <input type="number" class="form-input" id="depositAmount" placeholder="Enter amount" min="10" step="0.01">
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" id="cancelApprove">
                    <i class="fas fa-times"></i>
                    Cancel
                </button>
                <button class="modal-btn" id="confirmApprove">
                    <i class="fas fa-check"></i>
                    Approve
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-message" id="toastMessage"></div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCxNdlkjZiRYuB4_CZK093x0_K653LBEA4",
            authDomain: "mixysmm.firebaseapp.com",
            databaseURL: "https://mixysmm-default-rtdb.firebaseio.com",
            projectId: "mixysmm",
            storageBucket: "mixysmm.appspot.com",
            messagingSenderId: "859627558817",
            appId: "1:859627558817:web:3de00ea2ca10f2b7625de0",
            measurementId: "G-38JMDFW99M"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        const storage = firebase.storage();

        // DOM Elements
        const authSection = document.getElementById('authSection');
        const adminNav = document.getElementById('adminNav');
        const mobileNav = document.getElementById('mobileNav');
        const adminDashboard = document.getElementById('adminDashboard');
        const depositRequests = document.getElementById('depositRequests');
        const addService = document.getElementById('addService');
        const apiConfig = document.getElementById('apiConfig');
        const qrConfig = document.getElementById('qrConfig');
        const sendDialog = document.getElementById('sendDialog');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
        const adminPassword = document.getElementById('adminPassword');
        const navBtns = document.querySelectorAll('.nav-btn');
        const mobileNavBtns = document.querySelectorAll('.mobile-nav-btn');
        const requestsBody = document.getElementById('requestsBody');
        const qrPreview = document.getElementById('qrPreview');
        const qrUrl = document.getElementById('qrUrl');
        const saveQrBtn = document.getElementById('saveQrBtn');
        const addServiceBtn = document.getElementById('addServiceBtn');
        const sendDialogBtn = document.getElementById('sendDialogBtn');
        const apiKey = document.getElementById('apiKey');
        const apiUrl = document.getElementById('apiUrl');
        const saveApiBtn = document.getElementById('saveApiBtn');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        const approveModal = document.getElementById('approveModal');
        const closeApprove = document.getElementById('closeApprove');
        const cancelApprove = document.getElementById('cancelApprove');
        const confirmApprove = document.getElementById('confirmApprove');
        const depositAmount = document.getElementById('depositAmount');
        const pendingDeposits = document.getElementById('pendingDeposits');
        const totalUsers = document.getElementById('totalUsers');
        const activeServices = document.getElementById('activeServices');
        const totalOrders = document.getElementById('totalOrders');

        // Global variables
        const ADMIN_PASSWORD = "smox79";
        let currentDepositKey = null;

        // Event Listeners
        loginBtn.addEventListener('click', adminLogin);
        logoutBtn.addEventListener('click', adminLogout);
        mobileLogoutBtn.addEventListener('click', adminLogout);
        
        navBtns.forEach(btn => {
            btn.addEventListener('click', () => switchSection(btn.dataset.section));
        });
        
        mobileNavBtns.forEach(btn => {
            if (btn.id !== 'mobileLogoutBtn') {
                btn.addEventListener('click', () => switchSection(btn.dataset.section));
            }
        });
        
        closeApprove.addEventListener('click', () => approveModal.classList.remove('show'));
        cancelApprove.addEventListener('click', () => approveModal.classList.remove('show'));
        confirmApprove.addEventListener('click', approveDeposit);
        saveQrBtn.addEventListener('click', updateQrCode);
        addServiceBtn.addEventListener('click', addNewService);
        saveApiBtn.addEventListener('click', saveApiConfig);
        sendDialogBtn.addEventListener('click', sendDialogToUsers);

        // Initialize the app
        function init() {
            // Check if already logged in
            if (localStorage.getItem('adminLoggedIn') === 'true') {
                showAdminPanel();
                loadDashboardStats();
                loadDepositRequests();
                loadQrCode();
                loadApiConfig();
            }
        }

        // Admin login
        function adminLogin() {
            const password = adminPassword.value.trim();
            
            if (password === ADMIN_PASSWORD) {
                loginBtn.innerHTML = '<span class="spinner"></span> Logging in...';
                setTimeout(() => {
                    localStorage.setItem('adminLoggedIn', 'true');
                    showToast('Admin login successful!');
                    showAdminPanel();
                    loadDashboardStats();
                    loadDepositRequests();
                    loadQrCode();
                    loadApiConfig();
                    loginBtn.innerHTML = '<i class="fas fa-lock"></i><span>Login</span>';
                }, 1000);
            } else {
                showToast('Invalid admin password', true);
            }
        }

        // Admin logout
        function adminLogout() {
            localStorage.removeItem('adminLoggedIn');
            showToast('Admin logged out');
            showAuthSection();
        }

        // Show auth section
        function showAuthSection() {
            authSection.style.display = 'flex';
            adminNav.style.display = 'none';
            mobileNav.style.display = 'none';
            adminDashboard.style.display = 'none';
            depositRequests.style.display = 'none';
            addService.style.display = 'none';
            apiConfig.style.display = 'none';
            qrConfig.style.display = 'none';
            sendDialog.style.display = 'none';
            adminPassword.value = '';
        }

        // Show admin panel
        function showAdminPanel() {
            authSection.style.display = 'none';
            adminNav.style.display = 'flex';
            
            // Show mobile nav only on mobile
            if (window.innerWidth <= 768) {
                mobileNav.style.display = 'block';
            }
            
            adminDashboard.style.display = 'block';
        }

        // Switch sections
        function switchSection(section) {
            // Hide all sections
            adminDashboard.style.display = 'none';
            depositRequests.style.display = 'none';
            addService.style.display = 'none';
            apiConfig.style.display = 'none';
            qrConfig.style.display = 'none';
            sendDialog.style.display = 'none';
            
            // Show selected section
            document.getElementById(section === 'dashboard' ? 'adminDashboard' : 
                                  section === 'deposits' ? 'depositRequests' : 
                                  section === 'services' ? 'addService' : 
                                  section === 'api' ? 'apiConfig' : 
                                  section === 'qr' ? 'qrConfig' : 
                                  'sendDialog').style.display = 'block';
            
            // Update active button in top nav
            navBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.section === section);
            });
            
            // Update active button in mobile nav
            mobileNavBtns.forEach(btn => {
                if (btn.dataset.section) {
                    btn.classList.toggle('active', btn.dataset.section === section);
                }
            });
            
            // Load data if needed
            if (section === 'deposits') {
                loadDepositRequests();
            } else if (section === 'qr') {
                loadQrCode();
            } else if (section === 'api') {
                loadApiConfig();
            }
        }

        // Load dashboard statistics
        function loadDashboardStats() {
            // Pending deposits
            database.ref('deposits').orderByChild('status').equalTo('pending').once('value')
                .then(snapshot => {
                    pendingDeposits.textContent = snapshot.numChildren();
                })
                .catch(error => {
                    console.error('Error loading pending deposits:', error);
                    showToast('Failed to load pending deposits', true);
                });
            
            // Total users
            database.ref('users').once('value')
                .then(snapshot => {
                    totalUsers.textContent = snapshot.numChildren();
                })
                .catch(error => {
                    console.error('Error loading total users:', error);
                    showToast('Failed to load user count', true);
                });
            
            // Active services
            database.ref('services').orderByChild('active').equalTo(true).once('value')
                .then(snapshot => {
                    activeServices.textContent = snapshot.numChildren();
                })
                .catch(error => {
                    console.error('Error loading active services:', error);
                    showToast('Failed to load services', true);
                });
            
            // Total orders
            database.ref('orders').once('value')
                .then(snapshot => {
                    totalOrders.textContent = snapshot.numChildren();
                })
                .catch(error => {
                    console.error('Error loading total orders:', error);
                    showToast('Failed to load order count', true);
                });
        }

        // Load deposit requests
        function loadDepositRequests() {
            requestsBody.innerHTML = '<tr><td colspan="6" class="empty-state"><i>📊</i><p>Loading deposit requests...</p></td></tr>';
            
            database.ref('deposits').orderByChild('status').equalTo('pending').once('value')
                .then(snapshot => {
                    if (snapshot.exists()) {
                        requestsBody.innerHTML = '';
                        snapshot.forEach(childSnapshot => {
                            const deposit = childSnapshot.val();
                            const date = new Date(deposit.timestamp);
                            const dateStr = date.toLocaleString();
                            
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${dateStr}</td>
                                <td>${deposit.email || deposit.userId}</td>
                                <td>${deposit.utr || 'N/A'}</td>
                                <td>₹${deposit.amount || '0.00'}</td>
                                <td>${deposit.status}</td>
                                <td class="action-buttons">
                                    <button class="btn btn-approve" data-key="${childSnapshot.key}">
                                        <i class="fas fa-check"></i> Approve
                                    </button>
                                    <button class="btn btn-reject" data-key="${childSnapshot.key}">
                                        <i class="fas fa-times"></i> Reject
                                    </button>
                                </td>
                            `;
                            requestsBody.appendChild(row);
                        });
                        
                        // Add event listeners to new buttons
                        document.querySelectorAll('.btn-approve').forEach(btn => {
                            btn.addEventListener('click', () => showApproveModal(btn.dataset.key));
                        });
                        
                        document.querySelectorAll('.btn-reject').forEach(btn => {
                            btn.addEventListener('click', () => rejectDeposit(btn.dataset.key));
                        });
                    } else {
                        requestsBody.innerHTML = '<tr><td colspan="6" class="empty-state"><i>📭</i><p>No pending deposit requests</p></td></tr>';
                    }
                })
                .catch(error => {
                    console.error('Error loading deposits:', error);
                    requestsBody.innerHTML = '<tr><td colspan="6" class="empty-state">Error loading deposits</td></tr>';
                    showToast('Failed to load deposit requests', true);
                });
        }

        // Show approve modal
        function showApproveModal(depositKey) {
            currentDepositKey = depositKey;
            depositAmount.value = '';
            approveModal.classList.add('show');
        }

        // Approve deposit
        function approveDeposit() {
            const amount = parseFloat(depositAmount.value);
            if (isNaN(amount) || amount < 10) {
                showToast('Please enter a valid amount (minimum ₹10)', true);
                return;
            }
            
            confirmApprove.innerHTML = '<span class="spinner"></span> Approving...';
            
            // Get deposit data
            database.ref('deposits/' + currentDepositKey).once('value')
                .then(snapshot => {
                    const deposit = snapshot.val();
                    const userId = deposit.userId;
                    
                    // Update deposit status
                    database.ref('deposits/' + currentDepositKey).update({
                        status: 'approved',
                        amount: amount,
                        approvedAt: firebase.database.ServerValue.TIMESTAMP
                    })
                    .then(() => {
                        // Update user balance
                        database.ref('users/' + userId + '/balance').transaction(balance => {
                            return (balance || 0) + amount;
                        })
                        .then(() => {
                            // Send notification to user
                            database.ref('alerts').set({
                                title: 'Deposit Approved',
                                message: `Your deposit of ₹${amount.toFixed(2)} has been approved!`
                            });
                            
                            showToast('Deposit approved successfully!');
                            approveModal.classList.remove('show');
                            loadDepositRequests();
                            loadDashboardStats();
                            confirmApprove.innerHTML = '<i class="fas fa-check"></i> Approve';
                        })
                        .catch(error => {
                            console.error('Error updating user balance:', error);
                            showToast('Failed to update user balance', true);
                            confirmApprove.innerHTML = '<i class="fas fa-check"></i> Approve';
                        });
                    })
                    .catch(error => {
                        console.error('Error updating deposit:', error);
                        showToast('Failed to approve deposit', true);
                        confirmApprove.innerHTML = '<i class="fas fa-check"></i> Approve';
                    });
                })
                .catch(error => {
                    console.error('Error fetching deposit:', error);
                    showToast('Failed to fetch deposit data', true);
                    confirmApprove.innerHTML = '<i class="fas fa-check"></i> Approve';
                });
        }

        // Reject deposit
        function rejectDeposit(depositKey) {
            if (confirm('Are you sure you want to reject this deposit?')) {
                database.ref('deposits/' + depositKey).update({
                    status: 'rejected',
                    rejectedAt: firebase.database.ServerValue.TIMESTAMP
                })
                .then(() => {
                    // Send notification to user
                    database.ref('alerts').set({
                        title: 'Deposit Rejected',
                        message: 'Your deposit request has been rejected. Please contact support.'
                    });
                    
                    showToast('Deposit rejected successfully!');
                    loadDepositRequests();
                    loadDashboardStats();
                })
                .catch(error => {
                    console.error('Error rejecting deposit:', error);
                    showToast('Failed to reject deposit', true);
                });
            }
        }

        // Load QR code
        function loadQrCode() {
            database.ref('qrCode').once('value')
                .then(snapshot => {
                    const qrData = snapshot.val();
                    if (qrData && qrData.url) {
                        qrPreview.src = qrData.url;
                        qrUrl.value = qrData.url;
                    } else {
                        qrPreview.src = '';
                        qrUrl.value = '';
                    }
                })
                .catch(error => {
                    console.error('Error loading QR code:', error);
                    showToast('Failed to load QR code', true);
                });
        }

        // Update QR code
        function updateQrCode() {
            const url = qrUrl.value.trim();
            if (!url) {
                showToast('Please enter a valid URL', true);
                return;
            }
            
            saveQrBtn.innerHTML = '<span class="spinner"></span> Saving...';
            
            database.ref('qrCode').set({ url: url })
                .then(() => {
                    showToast('QR code updated successfully!');
                    qrPreview.src = url;
                    saveQrBtn.innerHTML = '<i class="fas fa-sync-alt"></i><span>Update QR Code</span>';
                })
                .catch(error => {
                    console.error('Error updating QR code:', error);
                    showToast('Failed to update QR code: ' + error.message, true);
                    saveQrBtn.innerHTML = '<i class="fas fa-sync-alt"></i><span>Update QR Code</span>';
                });
        }

        // Add new service
        function addNewService() {
            const name = document.getElementById('serviceName').value.trim();
            const id = document.getElementById('serviceId').value.trim();
            const desc = document.getElementById('serviceDesc').value.trim();
            const rate = parseFloat(document.getElementById('serviceRate').value);
            const minQty = parseInt(document.getElementById('minQty').value);
            const category = document.getElementById('serviceCategory').value.trim();
            
            if (!name || !id || !desc || isNaN(rate) || rate <= 0 || isNaN(minQty) || minQty <= 0) {
                showToast('Please fill all fields with valid values', true);
                return;
            }
            
            addServiceBtn.innerHTML = '<span class="spinner"></span> Adding...';
            
            const serviceData = {
                name: name,
                serviceId: id,
                description: desc,
                shortDesc: desc.length > 100 ? desc.substring(0, 100) + '...' : desc,
                rate: rate,
                minQty: minQty,
                category: category || 'General',
                active: true,
                createdAt: firebase.database.ServerValue.TIMESTAMP
            };
            
            database.ref('services').push(serviceData)
                .then(() => {
                    showToast('Service added successfully!');
                    // Reset form
                    document.getElementById('serviceName').value = '';
                    document.getElementById('serviceId').value = '';
                    document.getElementById('serviceDesc').value = '';
                    document.getElementById('serviceRate').value = '';
                    document.getElementById('minQty').value = '';
                    document.getElementById('serviceCategory').value = '';
                    addServiceBtn.innerHTML = '<i class="fas fa-plus"></i><span>Add Service</span>';
                    loadDashboardStats();
                })
                .catch(error => {
                    console.error('Error adding service:', error);
                    showToast('Failed to add service: ' + error.message, true);
                    addServiceBtn.innerHTML = '<i class="fas fa-plus"></i><span>Add Service</span>';
                });
        }

        // Load API config
        function loadApiConfig() {
            database.ref('apiConfig').once('value')
                .then(snapshot => {
                    const config = snapshot.val();
                    if (config) {
                        apiKey.value = config.key || '';
                        apiUrl.value = config.url || '';
                    } else {
                        apiKey.value = '';
                        apiUrl.value = '';
                    }
                })
                .catch(error => {
                    console.error('Error loading API config:', error);
                    showToast('Failed to load API config', true);
                });
        }

        // Save API config
        function saveApiConfig() {
            const key = apiKey.value.trim();
            const url = apiUrl.value.trim();
            
            if (!key || !url) {
                showToast('Please fill both API Key and URL', true);
                return;
            }
            
            saveApiBtn.innerHTML = '<span class="spinner"></span> Saving...';
            
            database.ref('apiConfig').set({
                key: key,
                url: url
            })
            .then(() => {
                showToast('API configuration saved successfully!');
                saveApiBtn.innerHTML = '<i class="fas fa-save"></i><span>Save API Config</span>';
            })
            .catch(error => {
                console.error('Error saving API config:', error);
                showToast('Failed to save API config: ' + error.message, true);
                saveApiBtn.innerHTML = '<i class="fas fa-save"></i><span>Save API Config</span>';
            });
        }

        // Send dialog to users
        function sendDialogToUsers() {
            const title = document.getElementById('dialogTitle').value.trim();
            const message = document.getElementById('dialogMessage').value.trim();
            
            if (!title || !message) {
                showToast('Please fill both title and message', true);
                return;
            }
            
            sendDialogBtn.innerHTML = '<span class="spinner"></span> Sending...';
            
            database.ref('alerts').set({
                title: title,
                message: message
            })
            .then(() => {
                showToast('Dialog sent to all users!');
                sendDialogBtn.innerHTML = '<i class="fas fa-paper-plane"></i><span>Send Dialog to All Users</span>';
                document.getElementById('dialogTitle').value = '';
                document.getElementById('dialogMessage').value = '';
            })
            .catch(error => {
                console.error('Error sending dialog:', error);
                showToast('Failed to send dialog: ' + error.message, true);
                sendDialogBtn.innerHTML = '<i class="fas fa-paper-plane"></i><span>Send Dialog to All Users</span>';
            });
        }

        // Show toast notification
        function showToast(message, isError = false) {
            toastMessage.textContent = message;
            toast.className = isError ? 'toast error show' : 'toast show';
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 5000);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>
